
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Kevin Trowbridge: Software Developer. Husband. I ❤ Webpages.</title>
  <meta name="author" content="Kevin Trowbridge">

  
  <meta name="description" content="I&rsquo;ve been hearing about Rails 3 for quite a while now. I thought it was about time to install it and take it for a
drive. And I wanted to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.kevinmtrowbridge.com/2010-05-19-migrate-to-rails-3-and-ruby-1-9-while-working-on-rails-2-ruby-1-8-projects">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Kevin Trowbridge" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-7781322-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <img src="/images/t-for-trowbridge.png" style="float: left;">
  <h1><a href="/">Kevin Trowbridge</a></h1>
  
    <h2>Software Developer. Husband. I ❤ Webpages.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.kevinmtrowbridge.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/about.html">About</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Migrate to Rails 3 and Ruby 1.9, While Still Working on Rails 2, Ruby 1.8 Projects</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2010-05-19T00:00:00-07:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2010</span></span> <span class='time'>12:00 am</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://www.kevinmtrowbridge.com">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>I&rsquo;ve been hearing about Rails 3 for quite a while now. I thought it was about time to install it and take it for a
drive. And I wanted to upgrade to Ruby 1.9 too, while I was at it.</p>

<p>But I&rsquo;ve got several projects that still need Ruby 1.8.6 to run. So I discovered a tool called <em>Ruby version manager</em>
(<strong>RVM</strong>) that allows me to install many versions of ruby and switch between them (the tool works by storing different
versions of ruby and gems in specific directories, and juggling the environment&rsquo;s paths).</p>

<p>Rvm works well and greatly simplifies the pain of working with projects written in Rails 3 and Rails 2 on the same
machine.</p>

<h2>Installing Ruby 1.9</h2>

<p>Rails 3 can use either Ruby 1.8.7 or 1.9. It&rsquo;s probably time to start switching to Ruby 1.9, correct? But there is a
problem: I have (and you probably do too) bunches of projects that I do not want to (or maybe can&rsquo;t) migrate to the new
version of Ruby, or at least certainly not today. And so how to install and manage two versions of Ruby?</p>

<p>RVM is a command line tool which allows you to easily install, manage and work with multiple ruby environments from
interpreters to sets of gems.</p>

<p>I suggest you follow the <a href="https://rvm.io/rvm/install">installation instructions</a>.</p>

<p>Once you have installed Rvm, use it to painlessly install Ruby 1.9:</p>

<p>Note: I initially tried to install Ruby 1.9.2, but I ran into some wicked bugs when I tried to boot Rails. These issues
are documented here in this Ruby language <a href="http://redmine.ruby-lang.org/issues/show/1788">bug report</a>. There, folks
recommended upgrading to the ruby-head version. So I did that, and it resolved the issues that I had.</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">macbook:~$</span> rvm install ruby-head
<span class="go">Installing Ruby from source to: /Users/kmtrowbr/.rvm/rubies/ruby-head</span>
<span class="go">Updating ruby from http://svn.ruby-lang.org/repos/ruby/trunk</span>
<span class="go">Configuring ruby-head, this may take a while depending on your cpu(s)...</span>
<span class="go">Compiling ruby-head, this may take a while, depending on your cpu(s)...</span>
<span class="go">Installing ruby-head</span>
<span class="go">Installation of ruby-head is complete.</span>
<span class="go">Updating rubygems for /Users/kmtrowbr/.rvm/gems/ruby-head@global</span>
<span class="go">Updating rubygems for /Users/kmtrowbr/.rvm/gems/ruby-head</span>
<span class="go">Installing gems for ruby-head.</span>
<span class="go">Installing rdoc to /Users/kmtrowbr/.rvm/gems/ruby-head@global</span>
<span class="go">Installing rdoc to /Users/kmtrowbr/.rvm/gems/ruby-head</span>
<span class="go">Installing rake to /Users/kmtrowbr/.rvm/gems/ruby-head@global</span>
<span class="go">Installing rake to /Users/kmtrowbr/.rvm/gems/ruby-head</span>
<span class="go">Installation of gems for ruby-head is complete.</span></code></pre></div>


<p>Rvm works on a per-user-basis by playing with the shell paths. It places ruby into a hidden .rvm directory in your home
directory and adds and removes directories from the path to set you up with different versions of ruby.</p>

<p>So&mdash;aspiring to develop with Rails 3 and Ruby 1.9 by default in the future, I set rvm to load Ruby 1.9 by default when
I open a shell (by issuing another rvm command):</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">macbook:~$</span> rvm --default ruby-head
<span class="go">Close and reopen your shell so as to reload your &#39;default&#39; ruby version, and then check to see that it is indeed the </span>
<span class="go">1.9 version:</span>

<span class="gp">macbook:~$</span> ruby -v
<span class="go">ruby 1.9.3dev (2010-05-18 trunk 27869) [x86_64-darwin10.3.0]</span>
<span class="go">Installing Rails 3</span></code></pre></div>


<p>Now we&rsquo;ve got Ruby 1.9 installed, so let&rsquo;s install Rails. Rails comes as a bunch of gems, so installing it is a matter
of updating your rubygem program and then installing those gems.</p>

<p>How does Rvm work with gems? Well, it installs them into ruby-version-specific directories in its hidden .rvm
directories. Even rubygems is versioned. Here you can see how when I check the path of the Ruby executables when I have
the ruby-head version selected with Rvm, it&rsquo;s off in a strange special Rvm controlled place:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">macbook:~$</span> which ruby
<span class="go">/Users/kmtrowbr/.rvm/rubies/ruby-head/bin/ruby</span>
<span class="gp">macbook:~$</span> which gem
<span class="go">/Users/kmtrowbr/.rvm/rubies/ruby-head/bin/gem</span>
<span class="gp">macbook:~$</span> env <span class="p">|</span> grep ruby
<span class="go">GEM_HOME=/Users/kmtrowbr/.rvm/gems/ruby-head</span>
<span class="go">MY_RUBY_HOME=/Users/kmtrowbr/.rvm/rubies/ruby-head</span>
<span class="go">RUBY_VERSION=ruby-head</span></code></pre></div>


<p>So basically this means that once you are using Rvm you&rsquo;ll probably want to use it to install Ruby gems as well. In the
case of installing Rails, we want to install rails into the RVM environment that goes with rails 1.9. Rvm has
<a href="http://rvm.beginrescueend.com/rubies/rubygems/">documentation around this</a>.</p>

<p>The basic principle is to not use sudo to install gems. Since Rvm works by isolating code in your ~/.rvm (user level)
directory, it&rsquo;s a waste (and will probably screw things up) to use sudo gem install to install the gems in a system
level directory.</p>

<p>The second principle is to run rubygems through rvm. Rvm will invoke the version of rubygems that is associated with
that version of Ruby, and install the gems in the proper path.</p>

<p>So in the following sequence of commands I update rubygems to the most current version, check to see which version that
is, and then install the new rails:</p>

<p>Note how for some reason you have to install a bunch of prerequisite gems before installing the Rails 3 gem. I&rsquo;m not
sure why this is but these instructions come from DHH so &ndash; there must be a good reason!</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">macbook:~$</span> rvm ruby-head gem update --system
<span class="go">Updating RubyGems</span>
<span class="go">Nothing to update</span>

<span class="gp">macbook:~$</span> rvm ruby-head gem -v
<span class="go">1.3.7</span>

<span class="gp">macbook:~$</span> rvm ruby-head gem install tzinfo builder memcache-client rack rack-test rack-mount erubis mail text-format thor bundler i18n
<span class="gp">macbook:~$</span> rvm ruby-head gem install rails --prerelease
<span class="go">ruby-head: ruby 1.9.3dev (2010-05-18 trunk 27869) [x86_64-darwin10.3.0]</span>
<span class="go">installing rails ...</span>
<span class="go">rails  installed, output logged to:</span>
<span class="go">/Users/kmtrowbr/.rvm/log/ruby-head/gem.install.log</span></code></pre></div>


<h2>Switching between Rubies</h2>

<p>So there you have it folks. If you need to use Ruby 1.8.6 to work on that old Rails 2.3 project, just tell rvm to use
that as the version of ruby for that console session:</p>

<div class="highlight"><pre><code class="language-console" data-lang="console"><span class="gp">macbook:~$</span> rvm system
<span class="gp">macbook:~$</span> ruby -v
<span class="go">ruby 1.8.7 (2009-06-08 patchlevel 173) [universal-darwin10.0]</span>
<span class="go">Once you&#39;ve finished, you can switch back to Ruby 1.9:</span>

<span class="gp">macbook:~$</span> rvm default
<span class="gp">macbook:~$</span> ruby -v
<span class="go">ruby 1.9.3dev (2010-05-18 trunk 27869) [x86_64-darwin10.3.0]</span></code></pre></div>


<p>I know that most Rails developers are going to run into this situation as they straddle Rails 2 and 3 moving forward,
and if there is a better way of switching back and forth between Ruby 1.8.6 and 1.9, I have yet to hear of it!</p>

<p>What&rsquo;s your take on this?</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Kevin Trowbridge</span></span>

      




<time class='entry-date' datetime='2010-05-19T00:00:00-07:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>19</span><span class='date-suffix'>th</span>, <span class='date-year'>2010</span></span> <span class='time'>12:00 am</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/software/'>software</a>
  
</span>


    </p>
    <p class="meta">
      
        <a class="basic-alignment left" href="/2009-07-09-public-transportation-backpacking-trip-point-reyes" title="Previous Post: Public transportation backpacking trip to Point Reyes">&laquo; Public transportation backpacking trip to Point Reyes</a>
      
      
        <a class="basic-alignment right" href="/2010-05-21-integrating-mercurial-with-the-OSX-opendiff-tool" title="Next Post: Integrating Mercurial with the OSX opendiff tool">Integrating Mercurial with the OSX opendiff tool &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  &copy;2008-2014 by Kevin Trowbridge&mdash;All rights reserved. Thanks for visiting my site.
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a>.</span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'kevinmtrowbridge';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.kevinmtrowbridge.com/2010-05-19-migrate-to-rails-3-and-ruby-1-9-while-working-on-rails-2-ruby-1-8-projects';
        var disqus_url = 'http://www.kevinmtrowbridge.com/2010-05-19-migrate-to-rails-3-and-ruby-1-9-while-working-on-rails-2-ruby-1-8-projects';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





</body>
</html>
